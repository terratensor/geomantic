# –°–µ—Ä–≤–∏—Å —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

–°–µ—Ä–≤–∏—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–≥—Ä—É–∂–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å –≥–µ–æ–Ω–∏–º–æ–≤ (`geoname_dict`) –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

## üìã –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

| –§–æ—Ä–º–∞—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| CSV | ‚úÖ –ì–æ—Ç–æ–≤–æ | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π CSV —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º-–∑–∞–ø—è—Ç–æ–π |
| JSON | üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ | 
| XML | üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ |

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç

```bash
# –≠–∫—Å–ø–æ—Ä—Ç –≤ –ø–∞–ø–∫—É export —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–º–µ–Ω–µ–º
make export-csv
# –†–µ–∑—É–ª—å—Ç–∞—Ç: export/geoname_dict_20250224_143022.csv
```

### –≠–∫—Å–ø–æ—Ä—Ç –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª

```bash
# –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
make export-to FILE=/tmp/my_dictionary.csv

# –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
make export-to FILE=./backup/dictionary.csv
```

### –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

```bash
make export-here
# –†–µ–∑—É–ª—å—Ç–∞—Ç: ./geoname_dict.csv
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

CSV —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `name` | string | –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –æ–±—ä–µ–∫—Ç–∞ |
| `geohashes_string` | string | S2 –≥–µ–æ—Ö–µ—à–∏ (—Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) |
| `geohashes_uint64` | string | S2 –≥–µ–æ—Ö–µ—à–∏ (uint64, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) |
| `occurrences` | int | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–æ—Ö–µ—à–µ–π –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏ |
| `first_geoname_id` | int | ID –ø–µ—Ä–≤–æ–≥–æ –≤—Å—Ç—Ä–µ—Ç–∏–≤—à–µ–≥–æ—Å—è –æ–±—ä–µ–∫—Ç–∞ |

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏:

```csv
name,geohashes_string,geohashes_uint64,occurrences,first_geoname_id
Moscow,47856c,5153644095851200512,1,524901
New York,478efc,5156335700315996160,1,5128581
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–≠–∫—Å–ø–æ—Ä—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Manticore –∏–∑ `.env`:

```env
MANTICORE_HOST=localhost
MANTICORE_PORT=9309
```

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–µ—Ä–≤–∏—Å —ç–∫—Å–ø–æ—Ä—Ç–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω —Å —É—á—ë—Ç–æ–º —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏:

```
internal/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îî‚îÄ‚îÄ ports/
‚îÇ       ‚îî‚îÄ‚îÄ exporter.go        # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —ç–∫—Å–ø–æ—Ä—Ç–∞
‚îú‚îÄ‚îÄ adapters/
‚îÇ   ‚îî‚îÄ‚îÄ exporters/
‚îÇ       ‚îú‚îÄ‚îÄ csv_writer.go      # CSV —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ factory.go          # –§–∞–±—Ä–∏–∫–∞ writer'–æ–≤
‚îÇ       ‚îî‚îÄ‚îÄ (json_writer.go)    # JSON (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
‚îî‚îÄ‚îÄ app/
    ‚îî‚îÄ‚îÄ services/
        ‚îî‚îÄ‚îÄ export_service.go   # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
```

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞

1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª `internal/adapters/exporters/json_writer.go`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ports.RecordWriter`
3. –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –≤ `factory.go`

```go
type JSONWriter struct {
    // ...
}

func (w *JSONWriter) WriteHeader(columns []string) error { ... }
func (w *JSONWriter) WriteRecord(record map[string]interface{}) error { ... }
func (w *JSONWriter) Close() error { ... }
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞**: 10,000 –∑–∞–ø–∏—Å–µ–π (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- **–ü–æ—Ç–æ–∫–æ–≤–∞—è –∑–∞–ø–∏—Å—å**: –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –ø–∞–º—è—Ç—å
- **–°–∫–æ—Ä–æ—Å—Ç—å**: ~100,000 –∑–∞–ø–∏—Å–µ–π/—Å–µ–∫

–î–ª—è —Å–ª–æ–≤–∞—Ä—è –∏–∑ 40-50M –∑–∞–ø–∏—Å–µ–π —ç–∫—Å–ø–æ—Ä—Ç –∑–∞–Ω–∏–º–∞–µ—Ç ~8-10 –º–∏–Ω—É—Ç.

## üêõ –û—Ç–ª–∞–¥–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Manticore
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `geoname_dict` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ü–µ–ª–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
curl http://localhost:9309/sql -d "SHOW TABLES"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
curl http://localhost:9309/sql -d "SELECT COUNT(*) FROM geoname_dict"
```

## üì• –ì–æ—Ç–æ–≤—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –≥–æ—Ç–æ–≤—ã–µ –∫ –∑–∞–≥—Ä—É–∑–∫–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

## üì• –ì–æ—Ç–æ–≤—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### –°–ª–æ–≤–∞—Ä—å –∏–º—ë–Ω —Å –≥–µ–æ—Ö–µ—à–∞–º–∏ (`geoname_dict`)

–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –∏–∑ GeoNames (~50M –∑–∞–ø–∏—Å–µ–π) —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ –≥–µ–æ—Ö–µ—à–∞–º–∏ —É—Ä–æ–≤–Ω—è 9.

- **–§–∞–π–ª**: [`export/geoname_dict_20260224_203501.csv.gz`](./export/)
- **–†–∞–∑–º–µ—Ä**: ~350 MB (—Å–∂–∞—Ç—ã–π gzip)
- **–§–æ—Ä–º–∞—Ç**: CSV —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
- **–ö–æ–ª–æ–Ω–∫–∏**: `name`, `geohashes_string`, `geohashes_uint64`, `occurrences`, `first_geoname_id`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –†–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
gunzip -k geoname_dict_*.csv.gz

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏
zcat geoname_dict_*.csv.gz | head
